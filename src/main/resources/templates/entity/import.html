<!doctype html>
<html class="h-100">

<th:block th:insert="~{elements/head}" th:with="title=|group details|" />

<body class="h-100 d-flex flex-column">
  <th:block th:insert="~{elements/navbar}" />

  <main class="flex-grow-1 container">
    <h1 class="text-truncate">
      <th:block th:text="${group.name} ?: _">Import Group</th:block>
    </h1>

    <div class="mb-3 accordion" id="accordion">
      <div class="accordion-item">
        <div class="accordion-header">
          <button class="accordion-button fw-bold" data-bs-target="#fold-1" data-bs-toggle="collapse">
            Group Details
          </button>
        </div>
        <div class="accordion-collapse collapse show" id="fold-1" data-bs-parent="#accordion">
          <div class="accordion-body">
            <th:block th:insert="~{forms/group}" th:with="action=@{/import}" />
          </div>
        </div>
      </div>
      <div th:if="${exceptions.size()}" class="accordion-item">
        <div class="accordion-header">
          <button class="accordion-button collapsed fw-bold" data-bs-target="#fold-2" data-bs-toggle="collapse">
            Import Errors
          </button>
        </div>
        <div class="accordion-collapse collapse" id="fold-2" data-bs-parent="#accordion">
          <div class="accordion-body p-0">
            <div class="table-responsive">
              <table class="table m-0">
                <thead>
                  <tr>
                    <th class="text-end">Line</th>
                    <th>Error</th>
                  </tr>
                </thead>
                <tbody>
                  <th:block th:each="exception : ${exceptions}">
                    <tr th:each="message : ${exception.value}">
                      <td th:text="${exception.key}" class="text-end"></td>
                      <td th:text="${message}"></td>
                    </tr>
                  </th:block>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <th:block th:if="${page.hasContent()}">
      <h2>Status List</h2>
      <div class="table-responsive border rounded mb-3">
        <table class="table align-middle m-0">
          <thead>
            <tr>
              <th>Status</th>
              <th>Date (UTC)</th>
              <th class="text-end">Media</th>
              <th class="text-end">Errors</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="status : ${page}" th:object="${status}">
              <td th:text="*{status}"></td>
              <td th:text="*{date}"></td>
              <td th:text="*{media.size()}" class="text-end"></td>
              <td th:text="*{exceptions.size()}" class="text-end"></td>
            </tr>
          </tbody>
        </table>
      </div>
      <th:block th:if="${page.totalPages} > 1" th:insert="~{elements/pager}" />
    </th:block>
  </main>

  <th:block th:insert="~{elements/navend}" />
</body>

</html>
